<!DOCTYPE html>
<html>
<head>
	<!-- jQuery -->
	<script src="../motion/js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="../motion/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="../motion/js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="../motion/js/jquery.waypoints.min.js"></script>
	<!-- Main -->
	<script src="../motion/js/main.js"></script>
	<!-- Modernizr JS -->
	<script src="../motion/js/modernizr-2.6.2.min.js"></script>
	<!-- style.css -->
	<link rel="stylesheet" href="../motion/css/style.css">
	<!-- Animate.css -->
	<link rel="stylesheet" href="../motion/css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../motion/css/icomoon.css">
	<!-- Themify Icons-->
	<link rel="stylesheet" href="../motion/css/themify-icons.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../motion/css/bootstrap.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="../motion/css/style.css">
<script type="text/javascript">

var delete_schedules_url = "https://rbnqasw5vg.execute-api.us-east-2.amazonaws.com/Alpha/sys-admin-delete-schedule";
var get_schedules_url = "https://rbnqasw5vg.execute-api.us-east-2.amazonaws.com/Alpha/getschedulessysadmin";

function showSchedulesHeader(){
	var table = document.getElementById("schedules");

	// insert header
	var colHeader;
	var header = table.createTHead(0);
	var row = header.insertRow(0);

	colHeader = row.insertCell();
	colHeader.innerHTML = "Start Date";

	colHeader = row.insertCell();
	colHeader.innerHTML = "End Date";

	colHeader = row.insertCell();
	colHeader.innerHTML = "Day Start Hour";

	colHeader = row.insertCell();
	colHeader.innerHTML = "Day End Hour";

	colHeader = row.insertCell();
	colHeader.innerHTML = "Organizer";

	colHeader = row.insertCell();
	colHeader.innerHTML = "Creation Date";

	colHeader = row.insertCell();
	colHeader.innerHTML = "Creation Time";

}

function showSchedules(schedules){
	var table = document.getElementById("schedules");
	table.innerHTML = "";

	showSchedulesHeader();

	var row;
  var cell;
  for (var i=0; i<schedules.list.length; i++){

    row = table.insertRow();

    cell = row.insertCell();
    cell.innerHTML = schedules.list[i].startdate;

    cell = row.insertCell();
    cell.innerHTML = schedules.list[i].enddate;

    cell = row.insertCell();
    cell.innerHTML = schedules.list[i].daystarthour;

		cell = row.insertCell();
    cell.innerHTML = schedules.list[i].dayendhour;

		cell = row.insertCell();
    cell.innerHTML = schedules.list[i].organizer;

		cell = row.insertCell();
    cell.innerHTML = schedules.list[i].creationDate;

		cell = row.insertCell();
    cell.innerHTML = schedules.list[i].creationTime;

  }
}

function deleteSchedules(e){
	var Pform = document.PForm;
	var password = Pform.password.value;

	var form = document.deleteForm;
	var days = form.days.value;

	var data = {};
  data["days"] = days;
	data["password"] = password;

  var js = JSON.stringify(data);
  console.log("JS:" + js);
  var xhr = new XMLHttpRequest();
  xhr.open("POST", delete_schedules_url, true);

  // send the collected data as JSON
  xhr.send(js);

  // This will process results and update HTML as appropriate.
  xhr.onloadend = function () {
    if (xhr.readyState == XMLHttpRequest.DONE) {
      console.log ("XHR:" + xhr.responseText);
      if(xhr.status == 200){
        var js = JSON.parse(xhr.responseText);
      }
    }
  };
}

function getSchedules(e){
	var Pform = document.PForm;
	var password = Pform.password.value;

	var form = document.retrieveForm;
	var hours = form.hours.value;

  var params = "password="+password+"&hours="+hours;
  console.log("request: " + params);
  var xhr = new XMLHttpRequest();
  xhr.open("GET", get_schedules_url+"?"+params, true);

  // send the collected data as JSON
  xhr.send();

  // This will process results and update HTML as appropriate.
  xhr.onloadend = function () {
    console.log(xhr);
    console.log(xhr.request);
    if (xhr.readyState == XMLHttpRequest.DONE) {
      console.log ("XHR:" + xhr.responseText);
      if(xhr.status == 200){
        var schedules = JSON.parse(xhr.responseText);
        showSchedules(schedules);
      }
    }
  };

}

</script>
</head>

<body>

<div id = "page">

  <nav class="gtco-nav" role="navigation">
    <div class="container">

      <div class="row">
        <div class="col-sm-2 col-xs-2">
          <div id="gtco-logo"><a href="index.html">Tarazed</div>
        </div>
        <div class="col-xs-10 text-right fh5co-top-social">
          <ul class="gtco-social">
            <li><a href="https://github.com/marcuscop/Tarazed" class="icon-github"></i></a></li>
          </ul>
        </div>
      </div>

    </div>
  </nav>



  <div id="gtco-intro" style="margin-top: 150px;">

		<div class="row">
			<div class="col-md-10 col-md-offset-1 text-center" style="height: 200px;">
				<form name="PForm" method="post" >
					<div class="dtc animate-box">
						<div class="list-group-item">
							<h2 class="gradient-text">Welcome System Admin</h2>
						</div>
						<div class="list-group-item">
							<p class="gradient-text">Enter System Admin password to identify yourself</p>
							<input type="search" name="password" value="PASSWORD" />
						</div>
					</div>
				</form>
			</div>
		</div>

    <div class="row">

      <div class="col-md-1">
      </div>

      <div class="col-md-5">
          <div class="dtc animate-box">
            <form name="deleteForm" method="post" >
              <div class="list-group">
                <fieldset>
                  <div class="list-group-item">
                    <legend class="">Delete Old Schedules</legend>
                  </div>
                  <div class="list-group-item">
                    Days<br><input type="search" name="days" value="" />
                  </div>
                  <div class="list-group-item">
                    <legend></legend>
                    <input class="btn" type="button" value="Delete"  onClick="JavaScript:deleteSchedules(this)">
                  </div>

                </fieldset>
              </div>
            </form>
          </div>
      </div>

			<div class="col-md-5">
					<div class="dtc animate-box">
						<form name="retrieveForm" method="post" >
							<div class="list-group">
								<fieldset>
									<div class="list-group-item">
										<legend class="">Retrieve Schedules</legend>
									</div>
									<div class="list-group-item">
										Hours<br><input type="search" name="hours" value="" />
									</div>
									<div class="list-group-item">
										<legend></legend>
										<input class="btn" type="button" value="Retrive"  onClick="JavaScript:getSchedules(this)">
									</div>

								</fieldset>
							</div>
						</form>
					</div>
			</div>

			<div class="col-md-1">
      </div>
    </div>

    <div class="row">
      <div class="col-md-1">
      </div>
      <div class="col-md-10">
        <div class="dtc animate-box">
          <div class="calendar">
            <table class="table" id="schedules">
            </table>
          </div>
        </div>
      </div>
      <div class="col-md-1">
      </div>
    </div>

    <div class="panel-footer">
      <div class="row">
        <div class="col-sm-3">
            <h4>Authors</h4>
            <ul>
              <li>Marc Reardon</li>
              <li>Christian Tweed</li>
              <li>Thar Min Htet</li>
              <li>Yared Taye</li>
            </ul>
        </div>
        <div class="col-sm-4">
          <h4>Contact Us</h4>
          <p>mdreardon@wpi.edu or mdreardon@gmail.com</p>
          <p>603-370-3966</p>
          <p>tminhtet@wpi.edu or kianhtet@gmail.com</p>
          <p></p>
        </div>
        <div class="col-sm-5">
          <b>Description</b>
          <p>This project was a final submission for Software Engineering CS3733 at WPI.  System Admins can search for and delete recent schedules from here.  To create a schedule, visit the organizer page.</p>
        </div>
      </div>
    </div>

  </div>

</div>

</body>
</html>
